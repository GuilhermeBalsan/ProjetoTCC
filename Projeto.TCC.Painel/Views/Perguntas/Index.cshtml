@model IEnumerable<Projeto.TCC.Painel.Models.Pergunta>

@{
    ViewBag.Title = "Index";
}

@*<div class="row">
        <div class="col-md-10">
            <form class="form-inline" method="post" action="@Url.Action("Filtro", "Perguntas")">
                <div class="form-group">
                    <label class="sr-only" for="titulo">Titulo</label>
                    <input type="text" class="form-control" id="titulo" name="titulo" placeholder="Titulo">
                </div>
                <div class="form-group">
                    @Html.DropDownList("questionarioId", (IEnumerable<SelectListItem>)ViewBag.Questionarios, "Todos", new { @class = "form-control" })
                </div>
                <input type="submit" value="Filtro" class="btn btn-default" id="filtro" />
            </form>
        </div>
        <div class="col-md-2">
            <form class="form-inline" style="float: right;" method="post" action="@Url.Action("Index", "Perguntas")">
                <div class="form-group">
                    <input type="submit" value="Limpar Filtro" class="btn btn-default" id="limparFiltro" />
                </div>
            </form>
        </div>
    </div>*@

<p>
    @Html.ActionLink("Nova Pergunta", "Create", new { questionarioId = ViewBag.QuestionarioId })
</p>

<div class="panel panel-default">
    <div class="panel-heading">Gerenciar Perguntas: @ViewBag.Questionario</div>
    <table class="table">
        <tr>            
            <th>
                @Html.DisplayNameFor(model => model.Titulo)
            </th>
            <th>
                Qtde. Respostas
            </th>
            <th>
                Ações
            </th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>                
                <td>
                    @Html.DisplayFor(modelItem => item.Titulo)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Respostas.Count)
                </td>
                <td>
                    @Html.ActionLink("Editar", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Detalhes", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Deletar", "Delete", new { id = item.Id }) |
                    <a href="@Url.Action("Index", "Respostas", new { perguntaId = item.Id })">Gerenciar Respostas</a>
                </td>
            </tr>
        }

    </table>
</div>
<p>
    <a href="@Url.Action("Index", "Questionarios")">Voltar para Questionarios</a>
</p>

@*<script>
        $(function () {
            $('#filtro').unbind('click');
            $('#filtro').on('click', function () {
                $.ajax({
                    url: "/Perguntas/Filtro",
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    dataType: 'json',
                    data: JSON.stringify({
                        titulo: $("#titulo").val()
                    }),
                    async: false
                });
            });
        });

        //$(document).ready(function () {
        //    alert("ok");
        //});

    </script>*@
